generator client {
  provider = "prisma-client"
  output   = "../lib/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  emailVerified DateTime?
  image         String?
  accounts      Account[]
  sessions      Session[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  cart      Cart?
}

model Account {
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([provider, providerAccountId])
}

model Session {
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model VerificationToken {
  identifier String
  token      String
  expires    DateTime

  @@id([identifier, token])
}

// --- GLOBAL SETTINGS ---
// This stores things like the store name, contact email, and social links
// Usually, you only have one row in this table.
// --- GLOBAL STORE SETTINGS ---
model StoreSetting {
  id String @id @default("global")

  // Header / Top Bar (From your screenshot)
  topBarEmail   String  @default("mhhasanul@gmail.com")
  topBarPhone   String  @default("(12345)67890")
  allowLanguage Boolean @default(true) // For the English dropdown
  allowCurrency Boolean @default(true) // For the USD dropdown

  // Brand
  logoText String @default("Hekto")

  // Footer General (From your screenshot)
  footerAddress String @default("17 Princess Road, London, Greater London NW1 8JR, UK")
  copyright     String @default("Â©Webecy - All Rights Reserved")

  updatedAt DateTime @updatedAt
}

// --- NAVIGATION & FOOTER LINKS ---
// Use this to manage the "Categories", "Customer Care", and "Pages" columns
model LinkGroup {
  id      String      @id @default(cuid())
  title   String // e.g., "Categories", "Customer Care"
  section LinkSection @default(FOOTER)
  links   NavLink[]
  order   Int         @default(0) // To keep columns in order
}

model NavLink {
  id      String    @id @default(cuid())
  label   String // e.g., "Laptops & Computers"
  url     String // e.g., "/category/laptops"
  groupId String
  group   LinkGroup @relation(fields: [groupId], references: [id], onDelete: Cascade)
  order   Int       @default(0)
}

enum LinkSection {
  HEADER_MAIN // For Home, Pages, Products, Blog, Shop, Contact
  FOOTER
}

// --- CONTACT FORM SUBMISSIONS ---
// For the "Contact Us" page in the Figma file
model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String   @db.Text
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
}

// --- STATIC PAGES / FAQ ---
// To manage the content of pages like "About Us" or "FAQ" without hardcoding
model PageContent {
  id        String   @id @default(cuid())
  slug      String   @unique // e.g., "about-us", "faq"
  title     String
  content   String   @db.Text // Use JSON or Markdown here
  isActive  Boolean  @default(true)
  updatedAt DateTime @updatedAt
}

// --- NEWSLETTER ---
// Hekto usually has a "Subscribe to Newsletter" section in the footer
model NewsletterSubscriber {
  id        String   @id @default(cuid())
  email     String   @unique
  createdAt DateTime @default(now())
}

// --- HERO BANNER (Homepage Slider) ---
model HeroBanner {
  id String @id @default(cuid())

  // Marketing Content
  subTitle    String // e.g., "Best Furniture For Your Castle..."
  mainTitle   String // e.g., "New Furniture Collection Trends in 2024"
  description String @db.Text

  // Call to Action (The Button)
  buttonText String @default("Shop Now")
  buttonLink String @default("/shop")

  // Imagery
  imageUrl   String // The main product image (e.g., the Pink Chair)
  offTagText String? // e.g., "50% off" (The circular tag in Hekto)

  // Configuration
  isActive  Boolean  @default(true)
  order     Int      @default(0) // To control which slide comes first
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
model Product {
  id                 String @id @default(cuid())
  name               String
  code               String @unique
  price              Float
  discountPercentage Float? @default(0)

  // Design separation for the Hekto tabs
  imageUrl        String
  description     String? @db.Text // Short summary next to buy button
  longDescription String? @db.Text // Content for "Description" tab
  additionalInfo  String? @db.Text // Content for "Additional Info" tab

  // NEW: Technical Specifications
  // Using Json allows: { "Material": "Wood", "Style": "Modern" }
  specs Json? @default("{}")

  // Relations
  images ProductImage[]

  tags     String[]
  colors   String[]
  stock    Int      @default(0)
  isActive Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  categoryId String?
  category   Category? @relation(fields: [categoryId], references: [id])
  reviews    Review[]

  promoBanners  PromoBanner[]
  discountItems DiscountItem[]
  cartItems     CartItem[]

  @@index([tags])
  @@index([categoryId])
}

model ProductImage {
  id        String  @id @default(cuid())
  url       String
  isMain    Boolean @default(false)
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
}

model Review {
  id      String  @id @default(cuid())
  rating  Int // 1 to 5
  comment String? @db.Text

  // User info (simplified for now, usually links to a User model)
  reviewerName String @default("Anonymous")

  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
}

model Service {
  id          String   @id @default(cuid())
  title       String
  description String
  iconUrl     String? // For uploaded images
  iconName    String? // For Lucide icon names like "Truck", "Headphones"
  order       Int      @default(0) // To control display order
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model PromoBanner {
  id       String   @id @default(cuid())
  title    String // e.g., "Unique Features Of Latest & Trending Products"
  features String[] // ["All frames constructed...", "Reinforced with...", etc.]

  // Relation to the product for the "Add to Cart" functionality and price
  productId String
  product   Product @relation(fields: [productId], references: [id])

  // Optional: Allow custom image if you don't want to use the product's default image
  customImage String?

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TrendingPromo {
  id       String  @id @default(cuid())
  title    String // e.g., "23% off in all products"
  linkText String // e.g., "Shop Now" or "View Collection"
  linkUrl  String
  imageUrl String
  bgColor  String // e.g., "#FFF6FB" (Pinkish) or "#EEEFFB" (Blueish)
  isActive Boolean @default(true)
}

model Category {
  id       String  @id @default(cuid())
  name     String  @unique
  slug     String  @unique
  imageUrl String?

  products     Product[]
  discountItem DiscountItem?
  showOnTop    Boolean       @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model DiscountItem {
  id          String   @id @default(cuid())
  title       String // e.g., "20% Discount Of All Products"
  subtitle    String // e.g., "Eams Sofa Compact"
  description String   @db.Text
  features    String[] // Array of bullet points: ["Material expose like metals", "Simple neutral colours"]
  buttonText  String   @default("Shop Now")

  // Relations
  categoryId String   @unique
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  // Link to a specific product to show its image
  productId String
  product   Product @relation(fields: [productId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Brand {
  id        String   @id @default(cuid())
  name      String
  imageUrl  String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
}

model Newsletter {
  id         String @id @default(cuid())
  title      String @default("Get Latest Update By Subscribe Our Newsletter")
  bgImage    String @default("/images/newsletter-bg.png")
  buttonText String @default("Shop Now")
}

model BlogPost {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String   @db.Text // For the full blog body
  excerpt     String   @db.Text // The short text shown on the card
  author      String   @default("SoberAli")
  mainImage   String // The primary card image
  publishedAt DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Future-proofing for the single page
  category   String?
  tags       String[] @default([])
  isFeatured Boolean  @default(false)
}

model Cart {
  id     String     @id @default(cuid())
  userId String?    @unique // Optional: We might have guest carts later
  user   User?      @relation(fields: [userId], references: [id], onDelete: Cascade)
  items  CartItem[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CartItem {
  id     String @id @default(cuid())
  cartId String
  cart   Cart   @relation(fields: [cartId], references: [id], onDelete: Cascade)

  productId String
  product   Product @relation(fields: [productId], references: [id])

  quantity Int     @default(1)
  color    String? // Stores "Brown", "Red" etc.
  size     String? // Stores "XL", "M" etc.

  @@unique([cartId, productId, color, size])
}
